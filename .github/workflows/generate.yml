name: Generate JSONs

on:
    push:

permissions:                    # Global permissions configuration starts here
    contents: read                # 'read' access to repository contents
    pull-requests: write          # 'write' access to pull requests

jobs:
    generate:
        runs-on: ubuntu-latest
        steps:
            # Setup
            - uses: actions/checkout@v4
              with:
                fetch-depth: 0
            - uses: actions/setup-node@v4

            # Create JSONs

            - name: Generate JSONs
              run: npm run build

            # Commit
            - name: Commit files
              continue-on-error: true
              run: |
                git config --local user.email "github-actions[bot]@users.noreply.github.com"
                git config --local user.name "github-actions[bot]"
                git commit -a -m "Update JSONs from ${{ github.event.push.head_commit.message }}"
            - name: Push changes
              if: success()
              uses: ad-m/github-push-action@master
              with:
                branch: ${{ github.head_ref }}